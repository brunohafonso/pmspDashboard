var inputsDadosPessoais = document.querySelectorAll(
  "#dadosPessoais .form-control"
);
var inputsEndereco = document.querySelectorAll("#endereco .form-control");
var botaoEditarDadosPessoais = document.querySelector("#editarDadosPessoais");
var tabela = $("#tabela-escolas");


if (botaoEditarDadosPessoais != undefined) {
  botaoEditarDadosPessoais.addEventListener("click", function(e) {
    e.preventDefault();
    inputsDadosPessoais.forEach(function(input) {
      input.removeAttribute("disabled");
    });

    document.querySelector("#salvarDadosPesssoais").removeAttribute("disabled");
    document.querySelector("#cancelarDadosPesssoais").style.display =
      "inline-block";
    document
      .querySelector("#editarDadosPessoais")
      .setAttribute("disabled", "true");
  });

  document
    .querySelector("#cancelarDadosPesssoais")
    .addEventListener("click", function(e) {
      e.preventDefault();
      e.target.style.display = "none";
      document
        .querySelector("#salvarDadosPesssoais")
        .setAttribute("disabled", "true");
      inputsDadosPessoais.forEach(function(input) {
        input.setAttribute("disabled", "true");
      });
      document
        .querySelector("#editarDadosPessoais")
        .removeAttribute("disabled");
    });

  document
    .querySelector("#editarEndereco")
    .addEventListener("click", function(e) {
      e.preventDefault();
      inputsEndereco.forEach(function(input) {
        input.removeAttribute("disabled");
      });

      document.querySelector("#salvarEndereco").removeAttribute("disabled");
      document.querySelector("#cancelarEndereco").style.display =
        "inline-block";
      document
        .querySelector("#editarEndereco")
        .setAttribute("disabled", "true");
    });

  document
    .querySelector("#cancelarEndereco")
    .addEventListener("click", function(e) {
      e.preventDefault();
      e.target.style.display = "none";
      document
        .querySelector("#salvarEndereco")
        .setAttribute("disabled", "true");
      inputsEndereco.forEach(function(input) {
        input.setAttribute("disabled", "true");
      });

      document.querySelector("#editarEndereco").removeAttribute("disabled");
    });

  $(document).ready(function() {
    $("#salvarDadosPesssoais").click(function(e) {
      e.preventDefault();
      document.querySelector(".container-loading").classList.add("visivel");
      var dados = {
        Id: $("input[name='Id']").val(),
        QtdAtualizacoes: $("input[name='QtdAtualizacoes']").val(),
        IdLogin: $("input[name='IdLogin']").val(),
        NomeCompleto: $("input[name='NomeCompleto']").val(),
        RF: $("input[name='RF']").val(),
        EstadoCivil: $("select[name='EstadoCivil']").val(),
        Genero: $("select[name='Genero']").val(),
        Email: $("input[name='Email']").val(),
        DataNascimento: $("input[name='DataNascimento']").val(),
        Telefones: {
          Id: $("input[name='Telefones.Id']").val(),
          IdServidor: $("input[name='Telefones.IdServidor']").val(),
          QtdAtualizacoes: $("input[name='Telefones.QtdAtualizacoes']").val(),
          TelefoneResidencial: $(
            "input[name='Telefones.TelefoneResidencial']"
          ).val(),
          Celular: $("input[name='Telefones.Celular']").val(),
          WhatsApp: $("input[name='Telefones.WhatsApp']").val(),
          Recado: $("input[name='Telefones.Recado']").val(),
          OutroTelefone: $("input[name='Telefones.OutroTelefone']").val()
        },
        PreferenciaContato: $("select[name='PreferenciaContato']").val()
      };

      // alert(dados.EstadoCivil);
      // alert(JSON.stringify(dados));

      $.ajax({
        type: "POST",
        Accept: "application/json",
        contentType: "application/json",
        dataType: "json",
        url: "@Url.Action('Index', 'DadosPessoais')",
        data: JSON.stringify(dados),
        success: function(data) {
          data = JSON.parse(data);
          //alert(data.message);
          document.querySelector(".container-loading").classList.remove("visivel");
          document.querySelector(".alert").classList.add("alert-success");
          document.querySelector(".alert").classList.add("visivel");
          document.querySelector(".alert").innerHTML = data.message;
          document.querySelector("#cancelarDadosPesssoais").style.display = "none";
          document.querySelector("#salvarDadosPesssoais").setAttribute("disabled", "true");
          inputsDadosPessoais.forEach(function(input) {
            input.setAttribute("disabled", "true");
          });
          document.querySelector("#editarDadosPessoais").removeAttribute("disabled");
        },
        error: function(data) {
          data = JSON.parse(data);
          //alert(data.message);
          document.querySelector(".container-loading").classList.remove("visivel");
          document.querySelector(".alert").classList.add("alert-success");
          document.querySelector(".alert").classList.add("visivel");
          document.querySelector(".alert").innerHTML = data.message;
          document.querySelector("#cancelarDadosPesssoais").style.display = "none";
          document.querySelector("#salvarDadosPesssoais").setAttribute("disabled", "true");
          inputsDadosPessoais.forEach(function(input) {
            input.setAttribute("disabled", "true");
          });
          document.querySelector("#editarDadosPessoais").removeAttribute("disabled");
        }
      });
    });
  });
}
